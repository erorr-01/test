export default {
    async fetch(request) {
        const corsHeaders = {
            'Access-Control-Allow-Origin': '*',
            'Access-Control-Allow-Methods': 'GET, OPTIONS',
            'Access-Control-Allow-Headers': 'Content-Type',
            'Content-Type': 'application/json; charset=utf-8'
        };

        if (request.method === 'OPTIONS') return new Response(null, { headers: corsHeaders, status: 200 });
        if (request.method !== 'GET') return new Response(JSON.stringify({ error: 'Method not allowed' }), { status: 405, headers: corsHeaders });

        try {
            const url = new URL(request.url);
            const cardNumber = url.searchParams.get('card');
            const nationalCode = url.searchParams.get('national_code');

            if (!cardNumber && !nationalCode) return new Response(JSON.stringify({ error: 'کد ملی یا شماره کارت را وارد کنید.' }), { status: 400, headers: corsHeaders });

            if (nationalCode) {
                const validation = validateNationalCode(nationalCode);
                if (!validation.valid) return new Response(JSON.stringify({ error: 'کد ملی نامعتبر است.', details: validation.details }), { status: 400, headers: corsHeaders });

                let city = 'نامشخص', province = 'نامشخص', source = 'local';

                try {
                    const formData = new URLSearchParams();
                    formData.append('idcode', validation.formatted);
                    const res = await fetch('https://www.searchline.ir/Action::IdCode', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/x-www-form-urlencoded', 'User-Agent': 'Mozilla/5.0' },
                        body: formData
                    });

                    if (res.ok) {
                        const html = await res.text();
                        const pMatch = html.match(/استان\s*:\s*<h1>([^<]+)<\/h1>/i);
                        const cMatch = html.match(/شهر\s*:\s*<h1>([^<]+)<\/h1>/i);
                        if (pMatch && pMatch[1].trim() && pMatch[1].trim() !== 'عدم مجوز') province = pMatch[1].trim(), source = 'searchline';
                        if (cMatch && cMatch[1].trim() && cMatch[1].trim() !== 'عدم مجوز') city = cMatch[1].trim(), source = 'searchline';
                        if (html.includes('کدملی معتبر نمی باشد')) return new Response(JSON.stringify({ error: 'کد ملی در سامانه یافت نشد.', code: validation.formatted }), { status: 404, headers: corsHeaders });
                    }
                } catch (e) {
                    const area = validation.formatted.substring(0, 3);
                    const info = getCityByAreaCode(area);
                    city = info.city;
                    province = info.province;
                    source = 'local';
                }

                return new Response(JSON.stringify({
                    national_code: validation.formatted,
                    gender: validation.gender,
                    province,
                    city,
                    source,
                    timestamp: new Date().toLocaleString('fa-IR', { timeZone: 'Asia/Tehran', hour12: false, year: 'numeric', month: '2-digit', day: '2-digit', hour: '2-digit', minute: '2-digit', second: '2-digit' })
                }), { status: 200, headers: corsHeaders });
            }

            if (cardNumber) {
                if (cardNumber.length < 16 || !/^\d{16,19}$/.test(cardNumber)) return new Response(JSON.stringify({ error: 'شماره کارت نامعتبر است.' }), { status: 400, headers: corsHeaders });

                const apiRes = await fetch("https://my.tabdilcard.com/back/api/v1/user-b2c/service/bank/accountBlockingCard/preview  ", {
                    method: 'POST',
                    headers: {
                        "Accept": "application/json, text/plain, */*",
                        "Content-Type": "application/json",
                        "x-referer": "https://my.tabdilcard.com  "
                    },
                    body: JSON.stringify({ type: 16, card: cardNumber, paymentMethod: 1 })
                });

                if (!apiRes.ok) return new Response(JSON.stringify({ error: 'کارت یافت نشد.' }), { status: 404, headers: corsHeaders });

                const result = await apiRes.json();
                if (!result?.result?.bankName || !result?.result?.depositOwners) return new Response(JSON.stringify({ error: 'اطلاعات کارت یافت نشد.' }), { status: 404, headers: corsHeaders });

                return new Response(JSON.stringify({
                    bank: result.result.bankName,
                    owner: result.result.depositOwners,
                    tracking: result.trackingCode || '',
                    timestamp: new Date().toLocaleString('fa-IR', { timeZone: 'Asia/Tehran', hour12: false, year: 'numeric', month: '2-digit', day: '2-digit', hour: '2-digit', minute: '2-digit', second: '2-digit' })
                }), { status: 200, headers: corsHeaders });
            }

        } catch (error) {
            return new Response(JSON.stringify({ error: 'خطای سرور' }), { status: 500, headers: corsHeaders });
        }
    }
};

function validateNationalCode(input) {
    let code = input.trim().replace(/\s/g, '');
    if (code.length < 10) code = code.padStart(10, '0');
    if (code.length !== 10 || !/^\d{10}$/.test(code) || /^(\d)\1{9}$/.test(code)) return { valid: false, details: ['کد ملی نامعتبر است.'] };

    let sum = 0;
    for (let i = 0; i < 9; i++) sum += parseInt(code[i]) * (10 - i);
    let control = sum % 11;
    let lastDigit = parseInt(code[9]);
    let isValid = (control < 2 && lastDigit === control) || (control >= 2 && lastDigit === (11 - control));
    if (!isValid) return { valid: false, details: ['کد ملی نامعتبر است.'] };

    return {
        valid: true,
        formatted: code,
        gender: parseInt(code[9]) % 2 === 0 ? "زن" : "مرد"
    };
}

const cityDatabase = {
    '001': 'تهران', '002': 'تهران', '003': 'تهران', '004': 'تهران', '005': 'تهران', '006': 'تهران', '007': 'تهران', '008': 'تهران',
    '011': 'تهران', '015': 'تهران', '020': 'تهران', '025': 'تهران', '031': 'کرج', '032': 'کرج', '037': 'قم', '038': 'قم',
    '041': 'ورامین', '042': 'ورامین', '043': 'دماوند', '044': 'شمیران', '045': 'شمیران', '048': 'شهرری', '049': 'شهرری',
    '051': 'آشتیان', '052': 'اراک', '053': 'اراک', '055': 'خمین', '056': 'محلات', '057': 'دلیجان', '058': 'تفرش', '059': 'ساوه',
    '060': 'ساوه', '061': 'سربند', '062': 'سربند', '063': 'اسفراین', '064': 'بیرجند', '065': 'بیرجند', '067': 'بجنورد', '068': 'بجنورد',
    '069': 'تربت حیدریه', '070': 'تربت حیدریه', '072': 'تربت جام', '073': 'تربت جام', '074': 'تایباد', '075': 'جاجرم', '076': 'خواف',
    '077': 'درگز', '078': 'سبزوار', '079': 'سبزوار', '081': 'سرخس', '082': 'شیروان', '083': 'طبس', '084': 'فریمان', '085': 'فردوس',
    '086': 'قوچان', '087': 'قوچان', '088': 'قائنات', '089': 'کاشمر', '090': 'کاشمر', '091': 'گناباد', '092': 'مشهد', '093': 'مشهد',
    '094': 'مشهد', '096': 'مشهد', '097': 'مشهد', '098': 'مشهد', '105': 'نیشابور', '106': 'نیشابور', '108': 'نجف آباد', '109': 'نجف آباد',
    '110': 'فلاورجان', '111': 'فلاورجان', '112': 'فریدونشهر', '113': 'خمینی شهر', '114': 'خمینی شهر', '115': 'فریدن', '116': 'لنجان',
    '117': 'لنجان', '118': 'اردستان', '119': 'شهرضا', '120': 'سمیرم', '121': 'گلپایگان', '122': 'خوانسار', '123': 'نطنز', '124': 'نائین',
    '125': 'کاشان', '126': 'کاشان', '127': 'اصفهان', '128': 'اصفهان', '129': 'اصفهان', '136': 'تبریز', '137': 'تبریز', '138': 'تبریز',
    '145': 'اردبیل', '146': 'اردبیل', '149': 'اهر', '150': 'اهر', '154': 'مراغه', '155': 'مراغه', '159': 'هشترود', '160': 'هشترود',
    '161': 'مغان', '162': 'مغان', '163': 'خلخال', '164': 'سراب', '165': 'سراب', '166': 'مشکین شهر', '167': 'مشکین شهر', '168': 'بناب',
    '169': 'آذرشهر', '170': 'اسکو', '171': 'بستان آباد', '172': 'شبستر', '173': 'هریس', '174': 'اهواز', '175': 'اهواز', '181': 'آبادان',
    '182': 'خرمشهر', '183': 'ایذه', '184': 'ایذه', '185': 'بهبهان', '186': 'بهبهان', '187': 'شوشتر', '188': 'شوشتر', '189': 'شادگان',
    '190': 'رامهرمز', '191': 'رامهرمز', '192': 'اندیمشک', '193': 'اندیمشک', '194': 'بندرماهشهر', '195': 'بندرماهشهر', '196': 'مسجدسلیمان',
    '197': 'مسجدسلیمان', '198': 'دشت آزادگان', '199': 'دزفول', '200': 'دزفول', '202': 'گنبد کاووس', '203': 'گنبد کاووس', '205': 'بابل',
    '206': 'بابل', '208': 'ساری', '209': 'ساری', '211': 'گرگان', '212': 'گرگان', '213': 'آمل', '214': 'آمل', '215': 'قائمشهر',
    '216': 'قائمشهر', '217': 'بهشهر', '218': 'بهشهر', '219': 'نوشهر', '220': 'نوشهر', '221': 'تنکابن', '222': 'نور', '223': 'بندرترکمن',
    '224': 'کردکوی', '225': 'سوادکوه', '226': 'علی آباد', '227': 'رامسر', '228': 'شیراز', '229': 'شیراز', '230': 'شیراز', '236': 'کازرون',
    '237': 'کازرون', '238': 'ممسنی', '239': 'ممسنی', '240': 'آباده', '241': 'آباده', '242': 'مرودشت', '243': 'مرودشت', '244': 'فیروزآباد',
    '245': 'فیروزآباد', '246': 'جهرم', '247': 'جهرم', '248': 'داراب', '249': 'داراب', '250': 'لارستان', '251': 'لارستان', '252': 'استهبان',
    '253': 'اقلید', '255': 'نی ریز', '256': 'فسا', '257': 'فسا', '261': 'آستارا', '262': 'طالش', '263': 'طالش', '264': 'بندرانزلی',
    '265': 'رودبار', '266': 'صومعه سرا', '267': 'شفت', '268': 'رودسر', '269': 'رودسر', '270': 'لنگرود', '271': 'لاهیجان', '272': 'لاهیجان',
    '273': 'آستانه', '274': 'ارومیه', '275': 'ارومیه', '279': 'خوی', '280': 'خوی', '282': 'ماکو', '283': 'ماکو', '284': 'سلماس',
    '285': 'سلماس', '286': 'مهاباد', '287': 'مهاباد', '288': 'سردشت', '289': 'بوکان', '290': 'نقده', '291': 'سیه چشمه', '292': 'پیرانشهر',
    '293': 'شاهین دژ', '294': 'تکاب', '295': 'اشنویه', '296': 'میاندوآب', '297': 'میاندوآب', '302': 'جیرفت', '303': 'جیرفت', '304': 'رفسنجان',
    '305': 'رفسنجان', '306': 'سیرجان', '307': 'سیرجان', '308': 'زرند', '309': 'زرند', '310': 'بم', '311': 'بم', '312': 'بافت',
    '313': 'بافت', '314': 'شهربابک', '315': 'کهنوج', '316': 'کهنوج', '317': 'بردسیر', '318': 'گلباف', '319': 'شهداد', '320': 'فهرج',
    '321': 'راور', '322': 'پاوه', '323': 'پاوه', '324': 'کرمانشاه', '325': 'کرمانشاه', '330': 'کنگاور', '331': 'هرسین', '332': 'گیلانغرب',
    '333': 'اسلام آباد', '334': 'اسلام آباد', '335': 'سنقر', '336': 'سرپل ذهاب', '337': 'قصرشیرین', '338': 'بندرعباس', '339': 'بندرعباس',
    '341': 'میناب', '342': 'میناب', '343': 'بندرلنگه', '344': 'بندرلنگه', '345': 'قشم', '346': 'جاسک', '348': 'بستک', '349': 'بوشهر',
    '350': 'بوشهر', '351': 'دشتستان', '352': 'دشتستان', '353': 'بندر گناوه', '354': 'دشتی', '355': 'تنگستان', '356': 'کنگان', '357': 'دیر',
    '358': 'ایرانشهر', '359': 'ایرانشهر', '361': 'زاهدان', '362': 'زاهدان', '364': 'چابهار', '365': 'چابهار', '366': 'زابل', '367': 'زابل',
    '369': 'سراوان', '370': 'سراوان', '371': 'خاش', '372': 'سنندج', '373': 'سنندج', '375': 'سقز', '376': 'سقز', '377': 'بیجار',
    '378': 'بیجار', '379': 'قروه', '380': 'قروه', '381': 'مریوان', '382': 'مریوان', '383': 'کامیاران', '384': 'بانه', '385': 'دیواندره',
    '392': 'ملایر', '393': 'ملایر', '395': 'نهاوند', '396': 'نهاوند', '397': 'تویسرکان', '398': 'رزن', '399': 'رزن', '400': 'اسدآباد',
    '401': 'اسدآباد', '402': 'کبودرآهنگ', '403': 'کبودرآهنگ', '404': 'بهار', '405': 'بهار', '412': 'بروجرد', '413': 'بروجرد', '416': 'الیگودرز',
    '417': 'الیگودرز', '418': 'الشتر', '419': 'کوهدشت', '420': 'نورآباد', '421': 'دورود', '422': 'یاسوج', '423': 'یاسوج', '424': 'دهدشت',
    '425': 'دهدشت', '426': 'دوگنبدان', '431': 'قزوین', '432': 'قزوین', '438': 'تاکستان', '439': 'تاکستان', '442': 'یزد', '443': 'یزد',
    '444': 'اردکان', '445': 'تفت', '446': 'مهریز', '447': 'بافق', '448': 'میبد', '449': 'ایلام', '450': 'ایلام', '451': 'دهلران',
    '452': 'مهران', '453': 'چرداول', '454': 'آبدانان', '455': 'دره شهر', '456': 'سمنان', '457': 'دامغان', '458': 'شاهرود', '459': 'شاهرود',
    '460': 'گرمسار', '461': 'شهرکرد', '462': 'شهرکرد', '465': 'بروجن', '466': 'لردگان', '467': 'فارسان', '468': 'اردل', '469': 'رودان',
    '470': 'گاوبندی', '471': 'امور خارجه', '472': 'امور خارجه', '481': 'باغ ملک', '483': 'ازنا', '484': 'ازنا', '486': 'کلاله', '487': 'رامیان',
    '488': 'مینودشت', '489': 'ساوجبلاغ', '490': 'شهریار', '491': 'شهریار', '492': 'پلدشت', '493': 'چایپاره', '496': 'صحنه', '497': 'آق قلا',
    '498': 'بابلسر', '499': 'نکاء', '500': 'محمودآباد', '501': 'محمودآباد', '502': 'فامنین', '503': 'ابرکوه', '504': 'پارس آباد', '505': 'جلفا',
    '506': 'عجب شیر', '508': 'آبیک', '509': 'بوئین زهرا', '510': 'شاهین شهر', '511': 'شاهین شهر', '512': 'دهاقان', '513': 'بوانات', '514': 'سروستان',
    '515': 'لامرد', '516': 'ماسال', '517': 'سیاهکل', '518': 'خمام', '519': 'کلیبر', '520': 'میامی', '521': 'جغتای', '522': 'چناران',
    '523': 'درمیان', '524': 'مانه و سملقان', '525': 'نیک شهر', '526': 'شوش', '527': 'آغاجاری', '528': 'ویسیان', '529': 'بندر دیلم', '530': 'مهدیشهر',
    '531': 'مراوه تپه', '532': 'سعد آباد', '533': 'زهک', '534': 'بدره', '535': 'کوهبنان', '536': 'رودبار کهنوج', '537': 'فین', '538': 'آوج',
    '540': 'خور و بیابانک', '541': 'مبارکه', '542': 'انار', '543': 'هرات', '544': 'فراهان', '545': 'ترکمانچای', '546': 'بیضا', '547': 'خشت',
    '548': 'خرامه', '549': 'تیران', '550': 'لنده', '551': 'اشکذر', '552': 'نیر', '553': 'کلات', '554': 'خمیر', '555': 'کوهرنگ', '556': 'اسلامشهر',
    '557': 'اشترینان', '558': 'دهگلان', '559': 'ضیاءآباد', '561': 'بهاباد', '562': 'بجستان', '563': 'نهبندان', '564': 'جرقویه', '565': 'کوهپایه',
    '566': 'کوثر', '567': 'ورزقان', '568': 'بندپی', '569': 'شفت', '570': 'رضوانشهر', '571': 'وفس', '572': 'بردسکن', '573': 'جوین',
    '574': 'زبرخان', '575': 'چادگان', '576': 'چهاردانگه', '577': 'شیرگاه', '578': 'دودانگه', '579': 'گلوگاه', '580': 'الموت', '581': 'ملکشاهی',
    '582': 'جویبار', '583': 'رابر', '584': 'قلقل رود', '585': 'اروندکنار', '586': 'بشاگرد', '588': 'طارم سفلی', '590': 'رودبار', '591': 'راز',
    '592': 'پاپی', '593': 'هندودر', '595': 'ثلاث باباجانی', '596': 'روانسر', '597': 'لاشار', '598': 'رومشکان', '599': 'بهمنی', '600': 'چاروسا',
    '601': 'بیله سوار', '603': 'نیر', '604': 'هوراند', '605': 'ریگان', '606': 'عنبرآباد', '607': 'ماهان', '608': 'منوجان', '609': 'جم',
    '610': 'شبانکاره', '611': 'میرجاوه', '612': 'چغلوندی', '613': 'چگنی', '616': 'ایوان', '617': 'خنداب', '618': 'زرند', '619': 'آران',
    '620': 'باغ بهادران', '621': 'بوئین', '622': 'میمه', '623': 'صوفیان', '625': 'چمستان', '626': 'کجور', '627': 'کلاردشت', '628': 'گمیشان',
    '629': 'گندمان', '630': 'املش', '631': 'رحیم آباد', '632': 'فلارد', '633': 'کیار', '634': 'شیروان', '635': 'فاروج', '636': 'چاروایماق',
    '637': 'انزل', '638': 'سیلوانه', '640': 'شوط', '641': 'حمیل', '642': 'بیارجمند', '643': 'احمدآباد', '644': 'تخت جلگه', '646': 'سروآباد',
    '647': 'شراء', '648': 'ارسنجان', '649': 'اوز', '650': 'رشتخوار', '651': 'فیض آباد', '652': 'زیرکوه', '653': 'سنگر', '654': 'زرین دشت',
    '655': 'خفر', '656': 'کراش', '657': 'مهر', '658': 'پاکدشت', '659': 'فیروزکوه', '660': 'دولت آباد', '661': 'هندیجان', '662': 'رامشیر',
    '663': 'اندیکا', '664': 'کهریزک', '665': 'سعادت آباد', '666': 'رباط کریم', '667': 'ابوموسی', '668': 'سیب و سوران', '669': 'قصرقند', '670': 'آباده طشک',
    '671': 'جویم', '673': 'شیبکوه', '674': 'کرانی', '675': 'کشاورز', '676': 'نمشیر', '677': 'تخت سلیمان', '678': 'اشکنان', '679': 'فراشبند',
    '680': 'هویزه', '681': 'خرم بید', '682': 'بزمان', '683': 'کوار', '684': 'ایوانکی', '685': 'امیدیه', '686': 'نمین', '687': 'باشت',
    '688': 'دروهان', '689': 'بندرگز', '690': 'انگوت', '691': 'باینگان', '692': 'سردشت', '693': 'کوچصفهان', '694': 'لشت نشاء', '695': 'طالقان',
    '696': 'میانکوه', '697': 'مارگون', '698': 'قلعه گنج', '699': 'فنوج', '700': 'بسطام', '701': 'دشتیاری', '702': 'کهک', '703': 'بمپور',
    '704': 'زابلی', '705': 'شیب آب', '706': 'بندر امام', '707': 'شاوور', '711': 'بندپی شرقی', '712': 'عباس آباد', '713': 'میاندورود', '714': 'خورش رستم',
    '715': 'سرعین', '716': 'سربیشه', '717': 'نظرآباد', '718': 'دستگردان', '719': 'سرایان', '720': 'راسک', '721': 'بشرویه', '722': 'ارزونیه',
    '723': 'قیروکارزین', '724': 'خلیل آباد', '725': 'کنارک', '726': 'زرین آباد', '727': 'موسیان', '728': 'البرز', '729': 'گتوند', '730': 'لالی',
    '731': 'ارشق', '732': 'دلوار'
};

function getCityByAreaCode(areaCode) {
    const city = cityDatabase[areaCode] || 'نامشخص';
    let province = 'نامشخص';
    const p = {
        "تهران": ['001','002','003','004','005','006','007','008','011','015','020','025','031','032','041','042','043','044','045','048','049','489','490','491','556','658','659','664','666','695','717'],
        "آذربایجان شرقی": ['136','137','138','149','150','154','155','159','160','164','165','168','169','170','171','172','173','505','506','519','545','567','604','623','636'],
        "آذربایجان غربی": ['274','275','279','280','282','283','284','285','286','287','288','289','290','291','292','293','294','295','296','297','492','493','637','638','640','675','677'],
        "اصفهان": ['108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','510','511','512','540','541','549','564','565','575','619','620','621','622','660'],
        "لرستان": ['416','417','418','419','420','421','483','484','528','592','612','613'],
        "خراسان جنوبی": ['064','065','085','088','523','563','652','716','719','721'],
        "خراسان رضوی": ['069','070','072','073','074','076','078','079','081','084','086','087','089','090','091','092','093','094','096','097','098','105','106','562','572','573','574','643','644','651','724'],
        "خراسان شمالی": ['063','067','068','075','082','524','591','635'],
        "سمنان": ['456','457','458','459','460','520','530','642','684','700'],
        "یزد": ['442','443','444','445','446','447','448','503','543','551','552','718'],
        "فارس": ['228','229','230','236','237','238','239','240','241','242','243','244','245','246','247','248','249','250','251','252','253','255','256','257','513','514','515','546','547','548','648','649','654','655','656','657','665','670','671','673','678','679','681','683','723'],
        "گیلان": ['261','262','263','264','265','266','267','268','269','270','271','272','273','516','517','518','570','593','630','631','653','693','694'],
        "مازندران": ['205','206','208','209','213','214','215','216','217','218','219','220','221','222','225','227','498','499','500','501','568','576','577','578','579','582','625','626','627','711','712','713'],
        "گلستان": ['202','203','211','212','223','224','226','486','487','488','497','531','628','689'],
        "اردبیل": ['145','146','161','162','163','504','601','603','686','690','714','715','731'],
        "زنجان": ['151','152','153','156','157','158','560','602','614','615','639','645'],
        "قزوین": ['431','432','438','439','508','509','538','559','580','588','590','728'],
        "قم": ['037','038','702'],
        "مرکزی": ['051','052','053','055','056','057','058','059','060','061','062','544','571','593','617','618'],
        "همدان": ['392','393','395','396','397','398','399','400','401','402','403','404','405','502','584','647'],
        "کرمانشاه": ['322','323','324','325','330','331','332','333','334','335','336','337','394','395','496','595','596','641','691'],
        "کهگیلویه و بویراحمد": ['422','423','424','425','426','550','599','600','687','688','697'],
        "کردستان": ['372','373','375','376','377','378','379','380','381','382','383','384','385','558','646','674','676'],
        "کرمان": ['298','299','302','303','304','305','306','307','308','309','310','311','312','313','314','315','316','317','318','319','320','321','535','536','542','583','605','606','607','608','698','722'],
        "بوشهر": ['349','350','351','352','353','354','355','356','357','529','532','609','610','732'],
        "چهارمحال و بختیاری": ['461','462','465','466','467','468','555','629','632','633','696'],
        "ایلام": ['449','450','451','452','453','454','455','534','581','616','726','727'],
        "سیستان و بلوچستان": ['358','359','361','362','364','365','366','367','369','370','371','525','533','597','635','668','669','682','699','701','703','704','705','720','725'],
        "خوزستان": ['174','175','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','527','585','661','662','663','680','685','706','707','729','730'],
        "خرم‌آباد": ['412','413','416','417','418','419','420','421','528','592','612','613']
    };
    for (let [key, codes] of Object.entries(p)) {
        if (codes.includes(areaCode)) {
            province = key;
            break;
        }
    }
    return { city, province };
}